name: StahovÃ¡nÃ­ pracovnÃ­ch nabÃ­dek

on:
  schedule:
    # SpustÃ­ skript kaÅ¾dÃ½ch 6 hodin (4x dennÄ›)
    - cron: '0 */6 * * *'
  # Tento Å™Ã¡dek umoÅ¾Åˆuje spustit skript i ruÄnÄ› pÅ™es zÃ¡loÅ¾ku "Actions" na GitHubu
  workflow_dispatch:

jobs:
  scrape-and-commit:
    runs-on: ubuntu-latest

    steps:
      # 1. Krok: KlonovÃ¡nÃ­ tvÃ©ho repozitÃ¡Å™e
      - name: KlonovÃ¡nÃ­ repozitÃ¡Å™e
        uses: actions/checkout@v4

      # 2. Krok: NastavenÃ­ sprÃ¡vnÃ© verze Pythonu
      - name: NastavenÃ­ Pythonu
        uses: actions/setup-python@v5
        with:
          python-version: '3.12' # MÅ¯Å¾eÅ¡ zmÄ›nit podle svÃ© potÅ™eby

      # 3. Krok: Instalace knihoven ze souboru requirements.txt
      - name: Instalace potÅ™ebnÃ½ch knihoven
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      # 4. Krok: SpuÅ¡tÄ›nÃ­ tvÃ©ho Python skriptu
      - name: SpuÅ¡tÄ›nÃ­ skriptu pro zÃ­skÃ¡nÃ­ dat
        # !!! ZDE ZMÄšÅ‡ 'tvuj_skript.py' NA SKUTEÄŒNÃ NÃZEV TVÃ‰HO SOUBORU !!!
        run: python Strankovani_python_old.py

      # 5. Krok: NahrÃ¡nÃ­ zmÄ›n (souboru Python_nabidky.txt) zpÄ›t do repozitÃ¡Å™e
      - name: Commit a push zmÄ›n
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add Python_nabidky.txt
          # Commit se provede pouze v pÅ™Ã­padÄ›, Å¾e se soubor zmÄ›nil
          if ! git diff --staged --quiet; then
            git commit -m "ğŸ¤– AutomatickÃ¡ aktualizace pracovnÃ­ch nabÃ­dek"
            git push
          else
            echo "Å½Ã¡dnÃ© novÃ© pracovnÃ­ nabÃ­dky k aktualizaci."
          fi 
